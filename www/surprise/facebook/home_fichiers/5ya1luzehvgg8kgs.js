/*    HTTP Host:  static.ak.fbcdn.net                                          */
/*    Generated:  March 28th 2009 3:37:37 PM PDT                               */
/*      Machine:  10.16.140.101                                                */
/*       Source:  Global Cache                                                 */
/*     Location:  js/5ya1luzehvgg8kgs.pkg.js h:ajmfrntd                        */
/*       Locale:  en_US                                                        */
/*         Path:  js/5ya1luzehvgg8kgs.pkg.js                                   */


function AdsFeedback(container){this.ad_container=container;this.feedback_div=DOM.find(this.ad_container,'div.ads_feedback');this.thumbs_up=DOM.find(this.ad_container,'a.thumbs_up');this.thumbs_dn=DOM.find(this.ad_container,'a.thumbs_dn');this.disable_if_dn=true;var next_ad_buttons=DOM.scry(this.ad_container,'a.next_ad');if(next_ad_buttons){this.next_ad_button=next_ad_buttons[0];}
this.usage_data=[];this.click_usage_data=[];this.enc_log_data='';this.cancel_btn={name:'cancel',label:_tx("Cancel"),className:'inputaux'};this.buttons=[Dialog.OK,this.cancel_btn];this.thumbs_up.listen('click',this._thumbs_up.bind(this));this.thumbs_dn.listen('click',this._thumbs_dn.bind(this));if(this.next_ad_button){this.next_ad_button.listen('click',this._cycle_muffin.bind(this));}}
copy_properties(AdsFeedback,{K_THUMBS_UP:1,K_THUMBS_DN:0,K_THUMBS_UP_FEEDBACK:1});copy_properties(AdsFeedback.prototype,{_thumbs_dn:function(){this.isPositive=false;this.click_usage_data=this.usage_data.clone();this.click_usage_data.push(AdsFeedback.K_THUMBS_DN);var async=new AsyncRequest().setMethod('GET').setReadOnly(true).setURI(muffinize('/muffins/ajax/feedback.php'));new Dialog().setAsync(async).setButtons(this.buttons).setHandler(this._form_handler.bind(this)).show();return false;},_thumbs_up:function(){this.isPositive=true;this.click_usage_data=this.usage_data.clone();this.click_usage_data.push(AdsFeedback.K_THUMBS_UP,AdsFeedback.K_THUMBS_UP_FEEDBACK,'');hide(this.thumbs_up);hide(this.thumbs_dn);this._log();return false;},_log:function(){var serialized_usage_data=this.click_usage_data.join('|');if(serialized_usage_data){var params='type=usage'+'&params[]='+escapeURI('ads_feedback')+'&params[]='+escapeURI(serialized_usage_data)+'&';new AsyncSignal(muffinize('/muffins/ajax/tracking_log.php?'+params)).send();}
if(this.enc_log_data){var adscribe_params='type=event'+'&params[]='+escapeURI('ads_feedback')+'&params[]='+escapeURI(this.enc_log_data)+'&params[]='+escapeURI(this.isPositive)+'&';new AsyncSignal(muffinize('/muffins/ajax/tracking_log.php?'+adscribe_params)).send();}},_form_handler:function(r){if(r==this.cancel_btn){var reason_value=0;var other_text='';}else if(r==Dialog.OK){var reason_select=$('ads_feedback_select');var reason_value=get_form_select_value(reason_select);var other_text=$('ads_feedback_form_other_text').value;if(!this.isPositive){this._cycle_muffin();if(this.disable_if_dn){this._disable_ad();}}
hide(this.thumbs_up);hide(this.thumbs_dn);}
this.click_usage_data.push(reason_value,other_text);this._log();},_disable_ad:function(){if(this.enc_log_data){var params='ld='+escapeURI(this.enc_log_data)+'&';new AsyncSignal(muffinize('/muffins/ajax/disable_muffin.php?'+params)).send();}},set_usage_data:function(usage_data){this.usage_data=usage_data;return this;},set_log_data:function(enc_log_data){this.enc_log_data=enc_log_data;return this;},_cycle_muffin:abstractMethod});function AdspaceAdsFeedback(container_id){var container=$(container_id);this.parent.construct(this,container);return this;}
AdspaceAdsFeedback.extend('AdsFeedback');copy_properties(AdspaceAdsFeedback.prototype,{_cycle_muffin:function(){var onResponse=function(asyncResponse){var payload=asyncResponse.getPayload();if(payload.html){DOM.replace(this.ad_container,HTML(payload['html']));}else{hide(this.feedback_div);}}.bind(this);var onError=function(asyncResponse){hide(this.feedback_div);}.bind(this);var page=URI.getRequestURI().getPath();ads_fetch_admarket_ad(page,null,null,onResponse,onError);return false;}});function EmuAdsFeedback(container_id){var container=$(container_id);this.parent.construct(this,container);this.disable_if_dn=false;return this;}
EmuAdsFeedback.extend('AdsFeedback');copy_properties(EmuAdsFeedback.prototype,{_cycle_muffin:function(){var onResponse=null;var onError=function(asyncResponse){hide(DOM.find(this.ad_container,'div.ads_feedback'));}.bind(this);var page=URI.getRequestURI().getPath();ads_refresh(null,page,onResponse,onError);return false;}});function AdnetAdspaceAdsFeedback(container_id,ad_location,adnetwork_id){var container=$(container_id);this.parent.construct(this,container);this.ad_location=ad_location;this.adnetwork_id=adnetwork_id;if(window.top.document.domain==window.document.domain){this.dialog_parent=window.top;}else{this.dialog_parent=window;}
this.buttons=this.dialog_parent.Dialog.OK_AND_CANCEL;return this;}
AdnetAdspaceAdsFeedback.extend('AdsFeedback');copy_properties(AdnetAdspaceAdsFeedback.prototype,{_thumbs_dn:function(){this.isPositive=false;this.click_usage_data=this.usage_data.clone();this.click_usage_data.push(AdsFeedback.K_THUMBS_DN);var async=new AsyncRequest().setMethod('GET').setReadOnly(true).setURI(muffinize('/muffins/ajax/feedback.php'));new this.dialog_parent.Dialog().setAsync(async).setButtons(this.buttons).setHandler(this._form_handler.bind(this)).show();return false;},_form_handler:function(r){if(r==this.dialog_parent.Dialog.OK){var reason_select=this.dialog_parent.DOM.getElement('ads_feedback_select');var reason_value=get_form_select_value(reason_select);var other_text=this.dialog_parent.DOM.getElement('ads_feedback_form_other_text').value;if(!this.isPositive){this._disable_ad();this._cycle_muffin();}
hide(this.thumbs_up);hide(this.thumbs_dn);this.click_usage_data.push(reason_value,other_text);this._log();}},_cycle_muffin:function(){var onResponse=function(asyncResponse){var payload=asyncResponse.getPayload();if(payload.html){DOM.replace(this.ad_container,HTML(payload['html']));}else{hide(this.feedback_div);}}.bind(this);var onError=function(asyncResponse){hide(this.feedback_div);}.bind(this);var page=URI.getRequestURI().getPath();ads_fetch_admarket_ad(page,this.ad_location,this.adnetwork_id,onResponse,onError);return false;}});function ads_feedback_select_onchange(){var select_elem=$('ads_feedback_select');var selected_index=select_elem.selectedIndex;if(selected_index==select_elem.options.length-1){show($('ads_feedback_form_other_text'));}else{hide($('ads_feedback_form_other_text'));}}

function emu_Client(_unitId,_unitType,_contextType,_root,_iData,_frameStates,_flags,_hash){this.unitId=_unitId;this.unitType=_unitType;this.contextType=_contextType;this.root=_root;this.iData=_iData;this.flags=_flags;this.hash=_hash;this.frameStates={};this.eventFrameId=null;this.setStates(_frameStates);DOMStorage.setData(this.root,'emuClient',this);}
copy_properties(emu_Client,{constants:{EMU_FRAME_EVENT_INIT:1,EMU_FRAME_EVENT_CLICK:2,EMU_FRAME_EVENT_SUBMIT:3,EMU_SERVER_COMMAND_RENDER_FRAME:1000,EMU_SERVER_COMMAND_SET_FRAME_STATE:1001,EMU_SERVER_COMMAND_PLAY_VIDEO:1003,EMU_CLIENT_COMMAND_FRAME_EVENT:2000,EMU_LINK_TARGET_DEFAULT:1,EMU_LINK_TARGET_NEW_WINDOW:2,EMU_FRAME_CONTEXT_TARGET_INLINE:1,EMU_FRAME_CONTEXT_TARGET_DIALOG:2,EMU_FRAME_EVENT_HANDLER:'/ajax/emu/h.php'},getParentDivId:function(unitId){return'emu_'+unitId;},getClient:function(unitId){var emuParent=ge(emu_Client.getParentDivId(unitId));if(!emuParent){return null;}
return DOMStorage.getData(emuParent,'emuClient');}});copy_properties(emu_Client.prototype,{getFrameDivId:function(frameId){return emu_Client.getParentDivId(this.unitId)+'_'+frameId;},_emuCmdHandler:function(asyncResponse){var payload=asyncResponse.getPayload();for(var i=0;i<payload.length;i++){var cmd=payload[i];switch(cmd.cmd){case emu_Client.constants.EMU_SERVER_COMMAND_RENDER_FRAME:if(emu_Client.constants.EMU_FRAME_CONTEXT_TARGET_INLINE==cmd.params.surface.targetType){var frameDivId=this.getFrameDivId(cmd.params.surface.targetId);var frame=ge(frameDivId);if(!frame){var frame=$N('div',{'id':frameDivId});this.root.appendChild(frame);}
set_inner_html(frame,cmd.params.surface.buffer);}else if(emu_Client.constants.EMU_FRAME_CONTEXT_TARGET_DIALOG==cmd.params.surface.targetType){if(!this.root.dialog||!this.root.dialog._showing){this.root.dialog=new Dialog();}
var d=this.root.dialog;if(cmd.params.surface.buffer){d.setBody(cmd.params.surface.buffer);}
if(cmd.params.surface.title){d.setTitle(cmd.params.surface.title);}
if(cmd.params.surface.width){d.setContentWidth(cmd.params.surface.width);}
d.setButtons(Dialog.OK).show();}
break;case emu_Client.constants.EMU_SERVER_COMMAND_SET_FRAME_STATE:this.frameStates[cmd.params.frameId]=cmd.params.state;break;}}
this.eventFrameId=null;},_emuErrorHandler:function(response){var progressElement=ge('submit_progress_'+this.eventFrameId);if(progressElement){CSS.addClass(progressElement,'hidden');}
frameDiv=ge(this.getFrameDivId(this.eventFrameId));if(frameDiv){var inputs=get_all_form_inputs(frameDiv);for(var i=0;i<inputs.length;i++){inputs[i].disabled=false;}}
this.eventFrameId=null;},setStates:function(states){for(var fn in states){this.frameStates[fn]=states[fn];}},onEvent:function(frameId,eventType,eventData){if(this.eventFrameId){return;}
this.eventFrameId=frameId;switch(eventType){case emu_Client.constants.EMU_FRAME_EVENT_CLICK:var ed=eventData;break;case emu_Client.constants.EMU_FRAME_EVENT_SUBMIT:var ed=serialize_form(eventData);var formInputs=get_all_form_inputs(eventData);for(var i=0;i<formInputs.length;i++){formInputs[i].disabled=true;}
var progressElement=ge('submit_progress_'+this.eventFrameId);if(progressElement){CSS.removeClass(progressElement,'hidden');}
break;}
var params={'fss':this.frameStates,'ut':this.unitType,'ct':this.contextType,'f':this.flags,'x':this.hash,'ida':this.iData,'c':emu_Client.constants.EMU_CLIENT_COMMAND_FRAME_EVENT,'fid':frameId,'et':eventType,'ed':ed,'rt':'a'};var r=new AsyncRequest();r.setURI(emu_Client.constants.EMU_FRAME_EVENT_HANDLER).setData(params).setHandler(bind(this,'_emuCmdHandler')).setErrorHandler(bind(this,'_emuErrorHandler')).setTransportErrorHandler(bind(this,'_emuErrorHandler')).send();},onRedirect:function(frameId,eventData,target){var f=this.root.appendChild($N('form',{'action':emu_Client.constants.EMU_FRAME_EVENT_HANDLER,'method':'POST','target':(emu_Client.constants.EMU_LINK_TARGET_NEW_WINDOW==target)?'_blank':'','style':{'display':'none'}}));var p={'ut':this.unitType,'ct':this.contextType,'f':this.flags,'x':this.hash,'ida':this.iData,'c':emu_Client.constants.EMU_CLIENT_COMMAND_FRAME_EVENT,'fid':frameId,'et':emu_Client.constants.EMU_FRAME_EVENT_CLICK,'rt':'h'};for(var edt in eventData){p['ed['+edt+']']=eventData[edt];}
for(var fn in this.frameStates){p['fss['+fn+']']=this.frameStates[fn];}
if(ge('post_form_id')){p['post_form_id']=$('post_form_id').value;}
for(var pn in p){f.appendChild($N('input',{'type':'hidden','name':pn,'value':p[pn]}));}
f.submit();this.root.removeChild(f);}});function emu_redirect_wrapper(obj){emu_Client.getClient(obj.adId).onRedirect(obj.frameId,obj.eventData,obj.target);return false;}
function emu_action_wrapper(obj){emu_Client.getClient(obj.adId).onEvent(obj.frameId,obj.eventType,obj.eventData);return false;}

if (window.Bootloader) { Bootloader.done(["js\/5ya1luzehvgg8kgs.pkg.js"]); }